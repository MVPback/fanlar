<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Matematika Yordamchisi</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
        font-family: Arial;
        background: linear-gradient(135deg, #2b5876, #4e4376);
        color: white;
        text-align: center;
        padding: 20px;
    }
    .container {
        background: rgba(255,255,255,0.1);
        padding: 20px;
        border-radius: 12px;
        max-width: 700px;
        margin: auto;
    }
    input {
        width: 90%;
        padding: 12px;
        border-radius: 6px;
        border: none;
        margin-bottom: 10px;
        font-size: 18px;
        text-align: right;
    }
    .buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        margin-bottom: 15px;
    }
    .btn {
        padding: 15px;
        font-size: 18px;
        border: none;
        border-radius: 6px;
        background: #00ff99;
        font-weight: bold;
        cursor: pointer;
    }
    .btn:hover {
        background: #00cc7a;
    }
    #result {
        margin-top: 15px;
        font-size: 18px;
        background: rgba(0,0,0,0.3);
        padding: 10px;
        border-radius: 8px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>üìê Matematika Yordamchisi</h2>
    <input type="text" id="formula" placeholder="Misol kiriting...">
    
    <!-- Oddiy kalkulyator tugmalari -->
    <div class="buttons">
        <button class="btn" onclick="insert('7')">7</button>
        <button class="btn" onclick="insert('8')">8</button>
        <button class="btn" onclick="insert('9')">9</button>
        <button class="btn" onclick="insert('/')">√∑</button>

        <button class="btn" onclick="insert('4')">4</button>
        <button class="btn" onclick="insert('5')">5</button>
        <button class="btn" onclick="insert('6')">6</button>
        <button class="btn" onclick="insert('*')">√ó</button>

        <button class="btn" onclick="insert('1')">1</button>
        <button class="btn" onclick="insert('2')">2</button>
        <button class="btn" onclick="insert('3')">3</button>
        <button class="btn" onclick="insert('-')">‚àí</button>

        <button class="btn" onclick="insert('0')">0</button>
        <button class="btn" onclick="insert('.')">.</button>
        <button class="btn" onclick="backspace()">‚å´</button>
        <button class="btn" onclick="insert('+')">+</button>

        <button class="btn" onclick="insert('(')">(</button>
        <button class="btn" onclick="insert(')')">)</button>
        <button class="btn" onclick="clearInput()">C</button>
        <button class="btn" onclick="hisobla()">=</button>
    </div>

    <!-- Maxsus matematik tugmalar -->
    <div class="buttons">
        <button class="btn" onclick="insert('sin(')">sin</button>
        <button class="btn" onclick="insert('cos(')">cos</button>
        <button class="btn" onclick="insert('tan(')">tan</button>
        <button class="btn" onclick="insert('sqrt(')">‚àö</button>

        <button class="btn" onclick="insert('log(')">log</button>
        <button class="btn" onclick="insert('pi')">œÄ</button>
        <button class="btn" onclick="insert('e')">e</button>
        <button class="btn" onclick="insert('^')">x ∏</button>
    </div>

    <button onclick="grafik()">Grafik Chiz</button>
    <div id="result"></div>
    <canvas id="myChart" width="400" height="300"></canvas>
</div>

<script>
let chart;

function insert(val) {
    document.getElementById("formula").value += val;
}
function clearInput() {
    document.getElementById("formula").value = "";
    document.getElementById("result").innerHTML = "";
}
function backspace() {
    let inp = document.getElementById("formula");
    inp.value = inp.value.slice(0, -1);
}

function hisobla() {
    let input = document.getElementById("formula").value.trim();
    let resultBox = document.getElementById("result");
    resultBox.innerHTML = "";

    try {
        if (input.includes("=")) {
            let parts = input.split("=");
            let left = parts[0];
            let right = parts[1];
            let eq = math.simplify(left + " - (" + right + ")");
            let solutions = math.solve(eq, "x");
            resultBox.innerHTML = "‚úè Tenglama ildizi: x = " + JSON.stringify(solutions);
            return;
        }
        let val = math.evaluate(input);
        resultBox.innerHTML = "üìä Natija: " + val;
    } catch (e) {
        resultBox.innerHTML = "‚ùå Xatolik: " + e.message;
    }
}

function grafik() {
    let formula = document.getElementById("formula").value.trim();

    if (!formula.startsWith("y=") && !formula.startsWith("y =")) {
        alert("Grafik uchun formulani 'y =' bilan boshlang!");
        return;
    }
    formula = formula.replace("y=", "").replace("y =", "").trim();

    let xValues = [];
    let yValues = [];

    for (let x = -10; x <= 10; x += 0.1) {
        try {
            let y = math.evaluate(formula, {x: x});
            xValues.push(x.toFixed(2));
            yValues.push(y);
        } catch {
            alert("Formulada xatolik bor!");
            return;
        }
    }

    if (chart) chart.destroy();

    let ctx = document.getElementById("myChart").getContext("2d");
    chart = new Chart(ctx, {
        type: "line",
        data: {
            labels: xValues,
            datasets: [{
                label: "y = " + formula,
                data: yValues,
                borderColor: "#00ff99",
                backgroundColor: "rgba(0,255,153,0.2)",
                borderWidth: 2,
                fill: true
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { labels: { color: "white" } }
            },
            scales: {
                x: { ticks: { color: "white" } },
                y: { ticks: { color: "white" } }
            }
        }
    });
}
</script>

</body>
</html>
