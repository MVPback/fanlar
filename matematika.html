<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Matematika Yordamchisi</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
        font-family: Arial;
        background: linear-gradient(135deg, #2b5876, #4e4376);
        color: white;
        text-align: center;
        padding: 20px;
    }
    .container {
        background: rgba(255,255,255,0.1);
        padding: 20px;
        border-radius: 12px;
        max-width: 700px;
        margin: auto;
    }
    input {
        width: 80%;
        padding: 10px;
        border-radius: 6px;
        border: none;
        margin-bottom: 10px;
        font-size: 16px;
    }
    button {
        margin: 5px;
        padding: 10px 15px;
        border: none;
        border-radius: 6px;
        background: #00ff99;
        font-weight: bold;
        cursor: pointer;
    }
    button:hover {
        background: #00cc7a;
    }
    #result {
        margin-top: 15px;
        font-size: 18px;
        background: rgba(0,0,0,0.3);
        padding: 10px;
        border-radius: 8px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>üìê Matematika Yordamchisi</h2>
    <input type="text" id="formula" placeholder="Misol kiriting... (masalan: 2x+5=0 yoki radius=5)">
    <br>
    <button onclick="hisobla()">Oddiy Javob</button>
    <button onclick="grafik()">Grafik Chiz</button>
    <div id="result"></div>
    <canvas id="myChart" width="400" height="300"></canvas>
</div>

<script>
let chart;

function hisobla() {
    let input = document.getElementById("formula").value.trim();
    let resultBox = document.getElementById("result");
    resultBox.innerHTML = "";

    try {
        // 1) Agar tenglama bo‚Äòlsa ( "=" bor )
        if (input.includes("=")) {
            let parts = input.split("=");
            let left = parts[0];
            let right = parts[1];
            let eq = math.simplify(left + " - (" + right + ")");
            let solutions = math.solve(eq, "x");
            resultBox.innerHTML = "‚úè Tenglama ildizi: x = " + JSON.stringify(solutions);
            return;
        }

        // 2) Geometriya formulalari
        if (input.includes("radius")) {
            let r = parseFloat(input.split("=")[1]);
            let S = Math.PI * r * r;
            resultBox.innerHTML = "üîµ Aylana yuzasi: " + S.toFixed(3);
            return;
        }
        if (input.includes("asos") && input.includes("balandlik")) {
            let parts = input.split(",");
            let a = parseFloat(parts[0].split("=")[1]);
            let h = parseFloat(parts[1].split("=")[1]);
            let S = 0.5 * a * h;
            resultBox.innerHTML = "üî∫ Uchburchak yuzasi: " + S;
            return;
        }

        // 3) Oddiy arifmetika yoki funksiya qiymati
        let val = math.evaluate(input);
        resultBox.innerHTML = "üìä Natija: " + val;

    } catch (e) {
        resultBox.innerHTML = "‚ùå Xatolik: " + e.message;
    }
}

function grafik() {
    let formula = document.getElementById("formula").value.trim();

    if (!formula.startsWith("y=") && !formula.startsWith("y =")) {
        alert("Grafik uchun formulani 'y =' bilan boshlang!");
        return;
    }
    formula = formula.replace("y=", "").replace("y =", "").trim();

    let xValues = [];
    let yValues = [];

    for (let x = -10; x <= 10; x += 0.1) {
        try {
            let y = math.evaluate(formula, {x: x});
            xValues.push(x.toFixed(2));
            yValues.push(y);
        } catch {
            alert("Formulada xatolik bor!");
            return;
        }
    }

    if (chart) chart.destroy();

    let ctx = document.getElementById("myChart").getContext("2d");
    chart = new Chart(ctx, {
        type: "line",
        data: {
            labels: xValues,
            datasets: [{
                label: "y = " + formula,
                data: yValues,
                borderColor: "#00ff99",
                backgroundColor: "rgba(0,255,153,0.2)",
                borderWidth: 2,
                fill: true
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { labels: { color: "white" } }
            },
            scales: {
                x: { ticks: { color: "white" } },
                y: { ticks: { color: "white" } }
            }
        }
    });
}
</script>

</body>
</html>
